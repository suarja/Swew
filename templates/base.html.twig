<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}SWE Wannabe{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><rect width=%22128%22 height=%22128%22 rx=%2220%22 fill=%22%23050505%22/><text y=%2290%22 x=%2210%22 font-size=%2296%22 font-family=%22monospace%22 fill=%22%2300ff9c%22>%3E_%3C/text></svg>">
        {% block stylesheets %}
            <link rel="stylesheet" href="{{ asset('styles/app.css') }}">
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>
    {% set current_path = app.request ? app.request.pathinfo : '/' %}
    {% set normalized_path = current_path == '' ? '/' : current_path %}
    {% set nav_links = [
        {'label': 'Home', 'href': '/', 'match': '/'},
        {'label': 'Courses', 'href': '/courses', 'match': '/courses'},
        {'label': 'CLI', 'href': '/cli', 'match': '/cli'},
        {'label': 'Docs', 'href': '/docs', 'match': '/docs'},
        {'label': 'Auth', 'href': '/auth', 'match': '/auth'},
        {'label': 'Device', 'href': '/device', 'match': '/device'},
        {'label': 'Profile', 'href': '/profile', 'match': '/profile'}
    ] %}
    <body class="min-h-screen bg-slate-50 text-slate-900">
        <div class="flex min-h-screen flex-col">
            <header class="app-header">
                <div class="header-inner">
                    <a href="/" class="brand-link">SWE Wannabe</a>
                    <nav class="nav-links" aria-label="Primary">
                        {% for link in nav_links %}
                            {% set is_active = link.match == '/' ? normalized_path == '/' : normalized_path starts with link.match %}
                            <a href="{{ link.href }}" class="nav-link {{ is_active ? 'is-active' : '' }}" {% if is_active %}aria-current="page"{% endif %}>{{ link.label }}</a>
                        {% endfor %}
                    </nav>
                    <div class="flex items-center gap-3">
                        <span class="status-indicator" data-component="status-indicator" aria-live="polite">queue · idle</span>
                        {% if app.user %}
                            <form method="post" action="{{ path('app_logout') }}">
                                <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
                                <button class="logout-button" type="submit">logout</button>
                            </form>
                        {% endif %}
                    </div>
                </div>
            </header>
            <main class="flex-1">
                <div class="shell-container">
                    {% block body %}{% endblock %}
                </div>
            </main>
            <footer class="app-footer">
                <div class="footer-inner" style="display:flex;justify-content:space-between;align-items:center;font-size:0.75rem;color:var(--text-muted);">
                    <span>CLI-first dojo · {{ 'now'|date('Y') }}</span>
                    <span style="letter-spacing:0.3em;text-transform:uppercase;">/usr/local/dojo</span>
                </div>
            </footer>
        </div>
    </body>
</html>
